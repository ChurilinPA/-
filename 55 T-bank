
1) 

select user_id,
        sum(case when success_flag = 1 then 1 else 0 end) as successful_orders_count,
        count(order_id) as orders_count,
        sum(case when success_flag = 1 then order_sum end) as total_successful_orders_sum,
        sum(case when success_flag = 1 then 1 else 0 end) * 1.0 / count(order_id) as success_rate
from orders
where date_trunc('month', order_date) = '2024-02-01'
group by user_id

2)

